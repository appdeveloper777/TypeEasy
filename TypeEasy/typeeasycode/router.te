/*
 * router.te - Enrutador Principal de la API
 *
 * Este script recibe la ruta de la API solicitada como un argumento
 * y decide qué datos devolver.
 */

// NOTA: Asumimos que tu intérprete de TypeEasy puede acceder a los
// argumentos de la línea de comandos a través de un array global 'ARGS'.
// ARGS[0] sería el nombre del script, ARGS[1] el primer argumento, etc.
// Si tu lenguaje no tiene esta capacidad, necesitarás implementarla primero.
let requested_uri = ARGS[1];

if (requested_uri == "/api/productos") {
    // --- Lógica para la ruta /api/productos ---
    class Producto {
      id : int;
      nombre : string;
      precio : int;
      stock : int;

      __constructor(id : int, nombre : string, precio : int, stock : int) {
        this.id = id;
        this.nombre = nombre;
        this.precio = precio;
        this.stock = stock;
      }
    }

    let productos = [
        new Producto(101, "Teclado Mecánico RGB", 80, 50),
        new Producto(102, "Mouse Gamer Inalámbrico", 50, 120),
        new Producto(205, "Monitor Curvo 27 pulgadas", 299, 35)
    ];

    // Aquí iría tu función nativa to_json(productos) en el futuro.
    // Por ahora, seguimos generando el JSON manualmente.
    print("[");
    let i = 0;
    for (let p in productos) {
        if (i > 0) { print(","); }
        print("{\"id\":"); print(p.id); print(",\"nombre\":\""); print(p.nombre); print("\",\"precio\":"); print(p.precio); print(",\"stock\":"); print(p.stock); print("}");
        i = i + 1;
    }
    print("]");

} else {
    // --- Ruta no encontrada ---
    // Devolvemos un JSON de error.
    print("{\"error\": \"Ruta no encontrada\", \"ruta\": \""); print(requested_uri); print("\"}");
}