// Ejemplo de conexión y consulta ORM a MySQL usando TypeEasy
// Parámetros de conexión MySQL XAMPP - Globales
/***************************************** */
class Usuario {
  id : int;
  usuario : string;
  email : string;
  __constructor(id : int, usuario : string, email : string) {
    this.id = id;
    this.usuario = usuario;
    this.email = email;
  }
}

/***************************************** */
// Endpoint para consultas ORM a MySQL
// Conexión a MySQL de XAMPP en la máquina host (Windows)
// host.docker.internal:3308 - puerto de XAMPP     
/***************************************** */
endpoint {

          [HttpGet("/api/mysql-orm/local-xampp-server/usuarios")]
          GetUsuariosORM() { 
              string host = "host.docker.internal";
              string user = "root";
              string pass = "";
              string db   = "meri";
              int port = 3308;                    
              let _conn_id = new mysql_connect(host, user, pass, db, port);
              // ORM: consulta y mapeo a objetos
              string _query = "SELECT * FROM users LIMIT 3";
              let _usuarios = orm_query(_conn_id, _query, Usuario);
              // Cerrar conexión
              mysql_close(_conn_id);
              // Retornar lista de usuarios como XML
              return xml(_usuarios);
        }
}